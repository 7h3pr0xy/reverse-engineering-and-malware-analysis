# Windows Platform

## Architecture

<center><img src='/images/windows_arch.png'></img></center>

## Windows Application Programming Interface (API)

The Windows API, informally WinAPI, is Microsoft's core set of application programming interfaces (APIs) available in the Microsoft Windows operating systems.  Almost all Windows programs interact with the Windows API. The Windows API abstract OS and system internals from application processes. This allow application developers to focus on their application logic instead of being burdended with system internals.

<center><img src='/images/win32_api.png'></img></center>

### Popular Windows API For Malware Development

Any malware written for the Windows platform is essentially a Windows application. In order to operate on Windows platform, it must conform to platform requirements and constraints. While there are different APIs or code paths through which various functional or malicious operation can be performed, below are list of common Windows API that are used for specific operations commonly found in malware samples.

### Process Manipulation and Injection

* OpenProcess
* TerminateProcess
* WriteProcessMemory
* CreateRemoteThread
* QueueUserAPC

### Keystroke Logging

* SetWindowsHookEx

### File Enumeration

* FindFirstFile

### Screenshot

* BitBlt

### Windows Registry API

* RegOpenKeyEx
* RegSetValue
* RegCreateKeyEx

## References

* [Windows Internals (Mark E. Russinovich, David A. Solomon, Alex Ionescu)](https://technet.microsoft.com/en-us/sysinternals/bb963901.aspx)
* <http://msdn.microsoft.com>
* <https://msdn.microsoft.com/en-us/library/windows/desktop/ff818516(v=vs.85).aspx>
* <https://en.wikipedia.org/wiki/Windows_API>