# Win32 API Counting


## Description

The challenge consists of an input executable that calls **ReadProcessMemory** Win32 API a certain number of times. The challenge involves simply counting the number of times this API is called.

## Solution

The expected solution involves using *scripted debugging* to count the number of times **ReadProcessMemory** is called. While it might be possible to use a conventional Windows debugger such as *WinDBG* or *OllyDBG* to set a breakpoint and manually count the number of times the breakpoint is hit. However such a solution will be inefficient and may be practically infeasible.

The following Ruby code utilizing [RbWinDBG](https://github.com/abhisek/RandomCode/tree/master/RbWinDBG) can be used to solve the challenge by automatically counting the number of times a given breakpoint is hit:

```ruby

require 'RbWinDBG'

if __FILE__ == $0
	RbWinDBG.init()
	
	count = 0
	dbg = RbWinDBG.start(ARGV[0])
	dbg.on_entrypoint do
		dbg.bpx(dbg.resolve_name('kernel32.dll!ReadProcessMemory')) do
			count += 1
		end
	end
	
	dbg.start()
	puts "Count: #{count}"
end

```